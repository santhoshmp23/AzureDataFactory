{
	"name": "DF_Ingest_Turbines_data",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "SqlDbCon",
						"type": "LinkedServiceReference"
					},
					"name": "SrcTurbinesData"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "SQLConTSC",
						"type": "LinkedServiceReference"
					},
					"name": "SinkTurbinesData",
					"rejectedDataLinkedService": {
						"referenceName": "ls_Pipeline_logs",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(output(",
				"          ScadaParkName as string,",
				"          ScadaParkCode as string,",
				"          ScadaParkId as integer,",
				"          ScadaParkSourceId as string,",
				"          TurbineName as string,",
				"          TurbineId as integer,",
				"          TechnicalId as integer,",
				"          DeviceId as integer,",
				"          OEMTechnicalId as string,",
				"          EquipmentNumber as long,",
				"          TurbineOEM as string,",
				"          TurbineFunctionalLocation as string,",
				"          S4HANATurbineFunctionalLocation as string,",
				"          S4HANALegacyTurbineFunctionalLocation as string,",
				"          TurbineModel as string,",
				"          TurbinePlatform as string,",
				"          LocationTypeName as string,",
				"          ProjectParkname as string,",
				"          ProjectParkCode as string,",
				"          ProjectParkId as integer,",
				"          ParkFunctionalLocation as string,",
				"          S4HANAParkFunctionalLocation as string,",
				"          S4HANALegacyParkFunctionalLocation as string,",
				"          OwnerName as string,",
				"          Timezone as string,",
				"          MicrosoftTimezone as string,",
				"          TimezoneOffsetMinutes as decimal(4,0),",
				"          TimezoneOffsetHour as decimal(10,6),",
				"          ControllerTypeDesc as string,",
				"          NominalPower as decimal(18,6),",
				"          HubHeight as decimal(18,6),",
				"          ControllerFamily as string,",
				"          TurbineType as string,",
				"          RotorDiameter as string,",
				"          Latitude as decimal(18,11),",
				"          Longitude as decimal(18,11),",
				"          Altitude as integer,",
				"          ParkEntryLongitude as decimal(18,11),",
				"          ParkEntryLatitude as decimal(18,11),",
				"          ProvinceName as string,",
				"          CountryName as string,",
				"          Code as string,",
				"          RegionName as string,",
				"          RegionShortName as string,",
				"          StatusTypeDesc as string,",
				"          CreatedBy as string,",
				"          CreatedDate as timestamp,",
				"          LastModifyBy as string,",
				"          LastModifyDate as timestamp,",
				"          TurbineStartUpDate as timestamp,",
				"          WarrantyStartDate as date,",
				"          WarrantyEndDate as date,",
				"          WindClass as string,",
				"          FTPName as string,",
				"          AverageDensity as decimal(6,3)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     waterMarkColumn: 'LastModifyDate',",
				"     format: 'table',",
				"     store: 'sqlserver',",
				"     schemaName: 'dbo',",
				"     tableName: 'TurbineMasterData',",
				"     isolationLevel: 'NONE',",
				"     mode: 'read') ~> SrcTurbinesData",
				"SrcTurbinesData sink(allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     input(",
				"          ID as long,",
				"          RegionName as string,",
				"          CountryName as string,",
				"          SiteId as integer,",
				"          SiteSourceId as string,",
				"          SiteName as string,",
				"          TurbineOEM as string,",
				"          OEMTechnicalId as string,",
				"          TechnicalId as integer,",
				"          TurbineId as integer,",
				"          StationName as string,",
				"          TurbinePlatform as string,",
				"          TurbineModel as string,",
				"          TurbineType as string,",
				"          Timezone as string,",
				"          ControllerFamily as string,",
				"          ControllerTypeDesc as string,",
				"          Latitude as decimal(18,11),",
				"          Longitude as decimal(18,11),",
				"          IPAddress as string,",
				"          SoftwareVersion as string,",
				"          IsActive as boolean,",
				"          CreatedDate as timestamp,",
				"          LastModifyDate as timestamp,",
				"          WSOSiteId as string",
				"     ),",
				"     format: 'table',",
				"     store: 'sqlserver',",
				"     schemaName: 'dbo',",
				"     tableName: 'TurbineData',",
				"     insertable: true,",
				"     updateable: false,",
				"     deletable: false,",
				"     upsertable: false,",
				"     stagingSchemaName: '',",
				"     saveOrder: 1,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     outputRejectedData: true,",
				"     outputAssertFailedRows: true,",
				"     assertFailure_container: 'pipelinelog',",
				"     mapColumn(",
				"          SiteName = ScadaParkName,",
				"          SiteId = ScadaParkId,",
				"          SiteSourceId = ScadaParkSourceId,",
				"          StationName = TurbineName,",
				"          TurbineId,",
				"          TechnicalId,",
				"          OEMTechnicalId,",
				"          TurbineModel,",
				"          TurbinePlatform,",
				"          TurbineType,",
				"          RegionName,",
				"          CountryName,",
				"          Timezone,",
				"          ControllerFamily,",
				"          ControllerTypeDesc",
				"     )) ~> SinkTurbinesData"
			]
		}
	}
}